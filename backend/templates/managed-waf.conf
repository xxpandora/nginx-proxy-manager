{% if managed_waf == 1 or managed_waf == true %}
############################ White List ############################
set $white_list_{{ id }}_access 0;
set $http_flood_block 0;

	if ($white_list_{{ id }} = 0) {
		set $white_list_{{ id }}_access 1;}
		
	if ($white_list_{{ id }}_access = 0) {
		set $http_flood_block 1;}
	
include /etc/nginx/conf.d/firewall-rules/firewall-rules.conf;

############################ Firewall Rule ############################

		#1# White List Access
if ($white_list_{{ id }}_access = 1) {
		set $action 0;}
		
		#2# Block HTTP Flood
if ($http_block = 12) {
		set $action 1;}

#		#3# Ban Bad Bot
#if ($ban_bad_bot = 1) {
#		set $action 1;}

		#4# Block Common Exploit 
if ($block_common_exploits = 1) {
		set $action 1;}

		#5# Block file injections
if ($block_file_injections = 1) {
		set $action 1;}

		#6# Block spam
if ($block_spam = 1) {
		set $action 1;}
		
		#7# Block SQL injections
if ($block_sql_injections = 1) {
		set $action 1;}
		
		#8# XmlRPC Block Client
if ($block_xml_rpc = 1) {
		set $action 1;}

##		#9# Search Query flood
##if ($search_control = 1) {
##		set $action 2;}

##### Block Spam IP and Country #####
		
	include /nginx/conf.d/context/http/asn-list/*.conf;
	include /nginx/conf.d/context/http/country-list/*.conf;
{% endif %}
